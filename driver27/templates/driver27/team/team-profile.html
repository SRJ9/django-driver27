{% extends 'driver27/base.html' %}
{% load static %}
{% block dr27_content %}
    {{ block.super }}
    <div class="container-fluid">
        <div class="col-md-9">
            <div class="driver_image demo col-xs-12 col-md-3"><span class="placeholder-img-text">Photo</span></div>
            <div class="col-xs-12 col-md-9">
                <h1>{{ team.full_name }} <i class="{{ team.country.flag_css }}"></i></h1>

            </div>
            <div class="clearfix"></div>
            <div class="col-md-12">
                {% if by_season %}
                    <h3>Stats by season</h3>
                    <table class="table table-striped text-right table-responsive">
                        <thead>
                        <tr>
                            <th>
                                {% if by_competition|length > 1 %}
                                    <select name="competition_selector" onchange="select_competition(this)">
                                        <option value="">---</option>
                                        {% for competition in by_competition %}
                                            <option value="{{ competition.competition.slug }}"
                                                    data-races="{{ competition.stats.RACE }}"
                                                    data-poles="{{ competition.stats.POLE }}"
                                                    data-wins="{{ competition.stats.WIN }}"
                                                    data-podiums="{{ competition.stats.PODIUM }}"
                                                    data-fastest="{{ competition.stats.FASTEST }}"
                                                    data-points="{{ competition.stats.POINTS }}"

                                            >{{ competition.competition }}</option>
                                        {% endfor %}
                                    </select>
                                {% endif %}
                            </th>
                            <th>Year</th>
                            <th>Races</th>
                            <th>P1</th>
                            <th>WIN</th>
                            <th>1-3</th>
                            <th>FL</th>
                            <th>Pts</th>
                        </tr>
                        </thead>

                        {% for season in by_season %}
                            <tr
                                    class="season-stat"
                                    data-competition="{{ season.competition.slug }}" data-year="{{ season.year }}"
                                    data-races="{{ season.stats.RACE }}" data-poles="{{ season.stats.POLE }}"
                                    data-wins="{{ season.stats.WIN }}" data-podiums="{{ season.stats.PODIUM }}"
                                    data-fastest="{{ season.stats.FASTEST }}" data-points="{{ season.stats.POINTS }}"
                            >
                                <td>
                                    <a href="{% url 'dr27-competition-view' season.competition.slug %}">{{ season.competition }}</a>
                                </td>
                                <td>
                                    <a href="{% url 'dr27-season-view' season.competition.slug season.year %}">{{ season.year }}</a>
                                </td>
                                <td>{{ season.stats.RACE }}</td>
                                <td>{{ season.stats.POLE }}</td>
                                <td>{{ season.stats.WIN }}</td>
                                <td>{{ season.stats.PODIUM }}</td>
                                <td>{{ season.stats.FASTEST }}</td>
                                <td>{{ season.stats.POINTS }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                {% else %}
                    No results
                {% endif %}

            </div>

        </div>
        <div class="col-md-3 driver_summary">
            <div class="col-xs-4 col-md-12"><span id="summary_race" class="summary_count" data-stat="races"
                                                  data-original="{{ stats.RACE }}">{{ stats.RACE }}</span> races
            </div>
            <div class="col-xs-4 col-md-12"><span id="summary_pole" class="summary_count" data-stat="poles"
                                                  data-original="{{ stats.POLE }}">{{ stats.POLE }}</span> poles
            </div>
            <div class="col-xs-4 col-md-12"><span id="summary_win" class="summary_count" data-stat="wins"
                                                  data-original="{{ stats.WIN }}">{{ stats.WIN }}</span> wins
            </div>
            <div class="clearfix"></div>
            <div class="col-xs-4 col-md-12"><span id="summary_podium" class="summary_count" data-stat="podiums"
                                                  data-original="{{ stats.PODIUM }}">{{ stats.PODIUM }}</span>
                podiums
            </div>
            <div class="col-xs-4 col-md-12"><span id="summary_fastest" class="summary_count" data-stat="fastest"
                                                  data-original="{{ stats.FASTEST }}">{{ stats.FASTEST }}</span>
                fastest laps
            </div>
            <div class="col-xs-4 col-md-12"><span id="summary_points" class="summary_count" data-stat="points"
                                                  data-original="{{ stats.POINTS }}">{{ stats.POINTS }}</span>
                points
            </div>

        </div>
        <div class="clearfix"></div>


    </div>



{% endblock %}

{% block bootstrap3_extra_head %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'flags/sprite.css' %}">

{% endblock %}

{% block bootstrap3_extra_script %}
    {{ block.super }}
        <script type="text/javascript">
        function select_competition(selector) {
            var selected = $(selector).find(':selected');
            if (selected) {
                var competition = selected.val();
                if (competition) {
                    $('.season-stat').each(function (index, element) {
                        if ($(element).data('competition') !== competition) {
                            $(element).addClass("hide");
                        } else {
                            $(element).removeClass("hide");
                        }
                    });
                    $('.summary_count').each(function (index, element) {
                        var stat = $(element).data('stat');
                        $(element).text($(selected).data(stat));
                    });
                } else {
                    $('.season-stat').removeClass('hide');
                    $('.summary_count').each(function (index, element) {
                        $(element).text($(element).data('original'));
                    })
                }
            }
        }

    </script>
{% endblock %}